<template>  <div class="swiper-layout-item">    <div class="swiper-container swiper-layout-parent" :style="{ height: menuHeight }" ref="swiper">      <div class="swiper-wrapper">        <div class="swiper-slide before-menu" :style="{ width: menuWidth }" v-if="type == 'left' || type == 'top'">          <slot name="menu"></slot>        </div>        <div class="swiper-slide content">          <slot name="content"></slot>        </div>        <div class="swiper-slide before-menu" :style="{ width: menuWidth }" v-if="type == 'right' || type == 'bottom'">          <slot name="menu"></slot>        </div>      </div>    </div>  </div></template><script type="text/ecmascript-6">  import Swiper from '../plugin/swiper/swiper-3.4.2.min'  function copyer(a, b) {    let c = {}    for(var i in a){      c[i] = a[i]    }    for(var i in b){      c[i] = b[i]    }    return c  }  export default{    name: 'swiper-layout',    props: {      type: { // 打开方向 分别为 top | right | bottom | left        type: String,        default: 'right'      },      menuWidth: { // 菜单大小 可以为 40% 40px 40rem        type: String,        default: '100%'      },      menuHeight: { // 菜单高度，当type为 top || bottom 时候需要设置此值        type: String,        default: 'auto'      },      blurClose: { // 失去焦点后是否关闭菜单        type: Boolean,        default: true      },      swiperConfig: {        type: Object // 本组件基于swiper@3.x, 如果需要个性配置，请参见swiper3.x api 文档      },      offsetNumber: {        type: Number,        default: 120      },      value: { // true 菜单打开， false 菜单关闭        type: Boolean,        default: true      }    },    data(){      return {        swiper: null,        isFirst: true,        isOpen: false,        isInit: false      }    },    mounted(){      let root = this      let baseConfig = {        //resistanceRatio : 0        onTouchStart(swiper){          // 解决swiper 对于 right 的错误删除          if(root.type == 'right' && !swiper.isEnd){            root.isFirst = true          }        },        onTouchEnd(swiper) {          // 解决swiper 对于 right 的判断错误          if(root.type == 'right'){            if(swiper.progress >= 0.35){              root.$emit('input', true)              swiper.slideTo(1)            }          }          if(root.isFirst && root.type == 'right' || root.isFirst && root.type == 'bottom'){ // 解决swiper的一个bug            root.isFirst = false            return          }          if(root.type == 'right' && swiper.isEnd){            if(swiper.touches.startX - swiper.touches.currentX >= root.offsetNumber){              root.$emit('offset', 'right')            }          }          if(root.type == 'left' && swiper.activeIndex == 0){            if(swiper.touches.startX - swiper.touches.currentX <= -root.offsetNumber){              root.$emit('offset', 'left')            }          }          if(root.type == 'top' && swiper.activeIndex == 0){            if(swiper.touches.startY - swiper.touches.currentY <= -root.offsetNumber){              root.$emit('offset', 'top')            }          }          if(root.type == 'bottom' && swiper.isEnd){            if(swiper.touches.startY - swiper.touches.currentY >= root.offsetNumber){              root.$emit('offset', 'bottom')            }          }        },        onTransitionEnd(swiper){          if(root.isInit){            if(root.type == 'right'){              if(swiper.isEnd){                root.$emit('input', true)              }else{                root.$emit('input', false)              }            }          }        },        onSlideChangeStart(swiper) {          // 在此响应里面值的变化          if(root.type == 'left' || root.type == 'top'){            if(swiper.activeIndex == 0){              // open              root.$emit('input', true)            }else if(swiper.activeIndex == 1){              // close              root.$emit('input', false)            }          }else if(root.type == 'bottom'){            if(swiper.activeIndex == 1){              // close              root.$emit('input', true)            }else{              // open              root.$emit('input', false)            }          }        }      }      // 首先覆盖优先级低的      baseConfig = copyer(baseConfig, this.swiperConfig)      // 覆盖之前做的准备      // 1. 如果是 type == left, 需要把index弄成1      if(this.type == 'left' || this.type == 'top'){        baseConfig.initialSlide = 1      }      if(this.type == 'top' || this.type == 'bottom'){        baseConfig.direction = 'vertical'      }      baseConfig = copyer(baseConfig, {        slidesPerView :'auto'      })      this.swiper = new Swiper (this.$refs.swiper, baseConfig)      root.isInit = true // 初始化完成    },    watch: {      value(newValue, oldValue){        // 动态根据值关闭        if(!newValue){          // 关闭          if(this.type == 'right' || this.type == 'bottom'){            this.swiper.slideTo(0)          }else if(this.type == 'left' || this.type == 'top'){            this.swiper.slideTo(1)          }        }else{          // 打开          if(this.type == 'right' || this.type == 'bottom'){            this.swiper.slideTo(1)          }else if(this.type == 'left' || this.type == 'top'){            this.swiper.slideTo(0)          }        }      }    }  }</script><style type="text/css">  @import "../plugin/swiper/swiper-3.4.2.min.css";  .swiper-layout-parent{    margin: inherit;    -webkit-box-sizing: border-box;    box-sizing: border-box;    width: 100%;  }  .swiper-layout-parent .swiper-slide{    -webkit-box-sizing: border-box;    box-sizing: border-box;  }  .swiper-layout-item{    width: 100%;    -webkit-box-sizing: border-box;    box-sizing: border-box;  }</style>